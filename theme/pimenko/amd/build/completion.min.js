/**
 * @copyright  Pimenko 2019
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_pimenko/completion",["jquery","core/str","theme_boost/bootstrap/tooltip"],(function($,str){let modulename=$("#completioncheck").attr("data-modulename"),tooltipAjxY=str.get_string("completion-tooltip-manual-y","theme_pimenko",modulename),tooltipAjxN=str.get_string("completion-tooltip-manual-n","theme_pimenko",modulename),checkbox=document.getElementsByTagName("input"),handle_success=function(res,o){"success"!==o&&alert("An error occurred when attempting to save your tick mark.\n\n("+o.responseText+".)")},handle_failure=function(res,o){alert("Failed: An error occurred when attempting to save your tick mark.\n\n("+o.responseText+".)")},toggle=function(e){e.preventDefault();let form=e.target;$.post({url:M.cfg.wwwroot+"/course/togglecompletion.php",data:"id="+form.getAttribute("data-id")+"&completionstate="+form.getAttribute("data-completionstate")+"&fromajax=1&sesskey="+M.cfg.sesskey}).done(handle_success).fail(handle_failure)};return{init:function(){for(let i=0;i<checkbox.length;i++)if("checkbox"===checkbox[i].type&&checkbox[i].className.includes("completioncheck")){let className="checkbox-parent";checkbox[i].checked&&(className+=" active"),checkbox[i].disabled&&(className+=" disable"),checkbox[i].parentNode.className=className,checkbox[i].onchange=function(event){toggle(event);let className="checkbox-parent";"1"===event.target.getAttribute("data-completionstate")?(className+=" active",event.target.setAttribute("data-completionstate",0),$.when(tooltipAjxY).done((function(tooltipTexty){$(event.target.parentNode).tooltip("hide").attr("data-original-title",tooltipTexty).tooltip("show")}))):(event.target.setAttribute("data-completionstate",1),$.when(tooltipAjxN).done((function(tooltipTextn){$(event.target.parentNode).tooltip("hide").attr("data-original-title",tooltipTextn).tooltip("show")}))),event.target.disabled&&(className+=" disable"),event.target.parentNode.className=className}}let help=Y.one("#completionprogressid");!help||Y.one("form.togglecompletion")||Y.one(".autocompletion")||help.setStyle("display","none")}}}));

//# sourceMappingURL=completion.min.js.map